<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Post-Quantum OpenMLS | OpenMLS</title><meta name=keywords content="mls,pq,openmls"><meta name=description content="Get started with post-quantum secure end-to-end encrypted with OpenMLS."><meta name=author content="Franziskus Kiefer"><link rel=canonical href=https://blog.openmls.tech/posts/2024-04-11-pq-openmls/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.openmls.tech/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.openmls.tech/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.openmls.tech/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.openmls.tech/apple-touch-icon.png><link rel=mask-icon href=https://blog.openmls.tech/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.openmls.tech/posts/2024-04-11-pq-openmls/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.openmls.tech/posts/2024-04-11-pq-openmls/"><meta property="og:site_name" content="OpenMLS"><meta property="og:title" content="Post-Quantum OpenMLS"><meta property="og:description" content="Get started with post-quantum secure end-to-end encrypted with OpenMLS."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-11T00:00:00+00:00"><meta property="article:modified_time" content="2024-04-11T00:00:00+00:00"><meta property="article:tag" content="Mls"><meta property="article:tag" content="Pq"><meta property="article:tag" content="Openmls"><meta name=twitter:card content="summary"><meta name=twitter:title content="Post-Quantum OpenMLS"><meta name=twitter:description content="Get started with post-quantum secure end-to-end encrypted with OpenMLS."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.openmls.tech/posts/"},{"@type":"ListItem","position":2,"name":"Post-Quantum OpenMLS","item":"https://blog.openmls.tech/posts/2024-04-11-pq-openmls/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Post-Quantum OpenMLS","name":"Post-Quantum OpenMLS","description":"Get started with post-quantum secure end-to-end encrypted with OpenMLS.","keywords":["mls","pq","openmls"],"articleBody":"OpenMLS now offers security against harvest-now-decrypt-later (HNDL) quantum adversaries.\nIn #1546 we merged support for the X-Wing KEM draft, which is an early draft for securely combining elliptic-curve-based Diffie-Hellman with ML-KEM. In particular, OpenMLS now supports the ciphersuite MLS_256_XWING_CHACHA20POLY1305_SHA256_Ed25519 with ciphersuite 0x004D. There is no IANA code-point for this ciphersuite yet, such that interoperability may not be guaranteed. We work with other implementers towards interoperability of this ciphersuite.\nThe implementation uses Cryspen’s formally verified ML-KEM and x25519 implementations from libcrux. The implementations are not only formally verified for correctness, secret independence, and memory safety, but also amongst the fastest implementations. Users should not notice any significant performance differences when using this new ciphersuite. The threat of HNDL attackers requires applications to switch to post-quantum secure mechanisms now, just like Signal and iMessage did already. OpenMLS offers a simple way to achieve security against HNDL attackers and is ready to use.\nPerformance While the new ML-KEM mechanism is very efficient, it requires larger messages and because the ciphersuite used is hybrid (i.e. a combination of ML-KEM the classical x25519 KEM), the workload increases.\nThe following tables give an overview of the performance and message sizes. One can clearly see an overhead from the post-quantum scheme. While the computation complexity is not too high, and more efficient implementations of ML-KEM may be used, the communication complexity increases significantly due to the larger key and message sizes in ML-KEM.\nComputation X-Wing + x25519 x25519 Create Key Package 273.39 µs 138.24 µs Create Welcome 665.77 µs 366.23 µs Join a group 733.22 µs 313.37 µs Self update 650.77 µs 294.49 µs Communication X-Wing + x25519 x25519 Key package size 2669 Bytes 299 Bytes Welcome size 5457 Bytes 716 Bytes Ratchet tree size 4007 Bytes 408 Bytes Self update size 3954 Bytes 495 Bytes Next Steps Using X-Wing as KEM in MLS is the easiest solution to achieve HNDL security for secure group messaging, or any use case that uses the state synchronization protocols specified in MLS.\nHowever, X-Wing is designed as a drop-in KEM scheme with very conservative security guarantees. In the context of MLS, there may be more efficient ways to integrate HNDL protection, for example, by making use of more lightweight KEM combiners, or by other means specific to MLS. In the context of the MLS working group, we are actively discussing multiple proposals for improved HNDL protection. Once more promising candidates are available, we will publish a follow-up of this post.\nA new version of OpenMLS will be released later this month, which will include this new, post-quantum secure, ciphersuite.\n","wordCount":"429","inLanguage":"en","datePublished":"2024-04-11T00:00:00Z","dateModified":"2024-04-11T00:00:00Z","author":{"@type":"Person","name":"Franziskus Kiefer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.openmls.tech/posts/2024-04-11-pq-openmls/"},"publisher":{"@type":"Organization","name":"OpenMLS","logo":{"@type":"ImageObject","url":"https://blog.openmls.tech/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.openmls.tech/ accesskey=h title="OpenMLS (Alt + H)">OpenMLS</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.openmls.tech/ title=Home><span>Home</span></a></li><li><a href=https://github.com/openmls/openmls title=Github><span>Github</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Post-Quantum OpenMLS</h1><div class=post-description>Get started with post-quantum secure end-to-end encrypted with OpenMLS.</div><div class=post-meta><span title='2024-04-11 00:00:00 +0000 UTC'>April 11, 2024</span>&nbsp;·&nbsp;Franziskus Kiefer</div></header><div class=post-content><p>OpenMLS now offers security against harvest-now-decrypt-later (HNDL) quantum adversaries.</p><p>In <a href=https://github.com/openmls/openmls/pull/1546>#1546</a> we merged support for the <a href=https://www.ietf.org/archive/id/draft-connolly-cfrg-xwing-kem-02.html>X-Wing KEM draft</a>, which is an early draft for securely combining elliptic-curve-based Diffie-Hellman with ML-KEM. In particular, OpenMLS now supports the ciphersuite MLS_256_XWING_CHACHA20POLY1305_SHA256_Ed25519 with ciphersuite 0x004D. There is no IANA code-point for this ciphersuite yet, such that interoperability may not be guaranteed. We work with other implementers towards interoperability of this ciphersuite.</p><p>The implementation uses Cryspen’s <a href=https://cryspen.com/post/ml-kem-verification/>formally verified ML-KEM</a> and x25519 implementations from <a href=https://github.com/cryspen/libcrux/>libcrux</a>. The implementations are not only formally verified for correctness, secret independence, and memory safety, but also amongst the fastest implementations. Users should not notice any significant performance differences when using this new ciphersuite.
The threat of HNDL attackers requires applications to switch to post-quantum secure mechanisms now, just like <a href=https://signal.org/blog/pqxdh/>Signal</a> and <a href=https://security.apple.com/blog/imessage-pq3/>iMessage</a> did already. OpenMLS offers a simple way to achieve security against HNDL attackers and is ready to use.</p><h2 id=performance>Performance<a hidden class=anchor aria-hidden=true href=#performance>#</a></h2><p>While the new ML-KEM mechanism is very efficient, it requires larger messages and because the ciphersuite used is hybrid (i.e. a combination of ML-KEM the classical x25519 KEM), the workload increases.</p><p>The following tables give an overview of the performance and message sizes.
One can clearly see an overhead from the post-quantum scheme.
While the computation complexity is not too high, and more efficient implementations of ML-KEM may be used, the communication complexity increases significantly due to the larger key and message sizes in ML-KEM.</p><h5 id=computation>Computation<a hidden class=anchor aria-hidden=true href=#computation>#</a></h5><table><thead><tr><th></th><th>X-Wing + x25519</th><th>x25519</th></tr></thead><tbody><tr><td>Create Key Package</td><td>273.39 µs</td><td>138.24 µs</td></tr><tr><td>Create Welcome</td><td>665.77 µs</td><td>366.23 µs</td></tr><tr><td>Join a group</td><td>733.22 µs</td><td>313.37 µs</td></tr><tr><td>Self update</td><td>650.77 µs</td><td>294.49 µs</td></tr></tbody></table><h5 id=communication>Communication<a hidden class=anchor aria-hidden=true href=#communication>#</a></h5><table><thead><tr><th></th><th>X-Wing + x25519</th><th>x25519</th></tr></thead><tbody><tr><td>Key package size</td><td>2669 Bytes</td><td>299 Bytes</td></tr><tr><td>Welcome size</td><td>5457 Bytes</td><td>716 Bytes</td></tr><tr><td>Ratchet tree size</td><td>4007 Bytes</td><td>408 Bytes</td></tr><tr><td>Self update size</td><td>3954 Bytes</td><td>495 Bytes</td></tr></tbody></table><h2 id=next-steps>Next Steps<a hidden class=anchor aria-hidden=true href=#next-steps>#</a></h2><p>Using X-Wing as KEM in MLS is the easiest solution to achieve HNDL security for secure group messaging, or any use case that uses the state synchronization protocols specified in MLS.</p><p>However, X-Wing is designed as a drop-in KEM scheme with very conservative security guarantees. In the context of MLS, there may be more efficient ways to integrate HNDL protection, for example, by making use of more lightweight KEM combiners, or by other means specific to MLS. In the context of the MLS working group, we are actively discussing multiple proposals for improved HNDL protection. Once more promising candidates are available, we will publish a follow-up of this post.</p><p>A new version of OpenMLS will be released later this month, which will include this new, post-quantum secure, ciphersuite.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.openmls.tech/tags/mls/>Mls</a></li><li><a href=https://blog.openmls.tech/tags/pq/>Pq</a></li><li><a href=https://blog.openmls.tech/tags/openmls/>Openmls</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.openmls.tech/>OpenMLS</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>