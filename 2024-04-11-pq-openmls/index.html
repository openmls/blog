<!doctype html><html><head><title>Post-Quantum OpenMLS // OpenMLS</title>
<meta charset=utf-8><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Get started with post-quantum secure end-to-end encrypted with OpenMLS."><meta property="og:title" content="Post-Quantum OpenMLS"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:locale" content="en"><meta property="og:url" content="https://openmls.tech/blog/2024-04-11-pq-openmls/"><link rel="shortcut icon" href=/favicon.ico><link href=https://openmls.tech/blog/webfonts/ptserif/main.css rel=stylesheet type=text/css><link href=https://openmls.tech/blog/webfonts/source-code-pro/main.css rel=stylesheet type=text/css><link rel=stylesheet href=https://openmls.tech/blog/css/style.css><meta name=generator content="Hugo 0.124.1"></head><body><div id=container><header id=header><div id=header-outer class=outer><div id=header-inner class=inner><a id=main-nav-toggle class=nav-icon href=javascript:;></a><a id=logo class=logo-text href=https://openmls.tech/blog/>OpenMLS</a><nav id=main-nav><a class=main-nav-link href=https://github.com/openmls/openmls>Github</a></nav><nav id=sub-nav><div id=search-form-wrap></div></nav></div></div></header><section id=main class=outer><article class="article article-type-post" itemscope itemprop=blogPost><div class=article-inner><header class=article-header><h1 class=article-title itemprop=name>Post-Quantum OpenMLS</h1></header><div class=article-meta><a href=/blog/2024-04-11-pq-openmls/ class=article-date><time datetime=2024-04-11T00:00:00.000+00:00 itemprop=datePublished>2024-04-11</time></a><pre style=color:#939393> by <a href=https://franziskuskiefer.de> Franziskus Kiefer </a></pre></div><div class=article-entry itemprop=articleBody><p>OpenMLS now offers security against harvest-now-decrypt-later (HNDL) quantum adversaries.</p><p>In <a href=https://github.com/openmls/openmls/pull/1546>#1546</a> we merged support for the <a href=https://www.ietf.org/archive/id/draft-connolly-cfrg-xwing-kem-02.html>X-Wing KEM draft</a>, which is an early draft for securely combining elliptic-curve-based Diffie-Hellman with ML-KEM. In particular, OpenMLS now supports the ciphersuite MLS_256_XWING_CHACHA20POLY1305_SHA256_Ed25519 with ciphersuite 0x004D. There is no IANA code-point for this ciphersuite yet, such that interoperability may not be guaranteed. We work with other implementers towards interoperability of this ciphersuite.</p><p>The implementation uses Cryspen’s <a href=https://cryspen.com/post/ml-kem-verification/>formally verified ML-KEM</a> and x25519 implementations from <a href=https://github.com/cryspen/libcrux/>libcrux</a>. The implementations are not only formally verified for correctness, secret independence, and memory safety, but also amongst the fastest implementations. Users should not notice any significant performance differences when using this new ciphersuite.
The threat of HNDL attackers requires applications to switch to post-quantum secure mechanisms now, just like <a href=https://signal.org/blog/pqxdh/>Signal</a> and <a href=https://security.apple.com/blog/imessage-pq3/>iMessage</a> did already. OpenMLS offers a simple way to achieve security against HNDL attackers and is ready to use.</p><h2 id=performance>Performance</h2><p>While the new ML-KEM mechanism is very efficient, it requires larger messages and because the ciphersuite used is hybrid (i.e. a combination of ML-KEM the classical x25519 KEM), the workload increases.</p><p>The following tables give an overview of the performance and message sizes.
One can clearly see an overhead from the post-quantum scheme.
While the computation complexity is not too high, and more efficient implementations of ML-KEM may be used, the communication complexity increases significantly due to the larger key and message sizes in ML-KEM.</p><h5 id=computation>Computation</h5><table><thead><tr><th></th><th>X-Wing + x25519</th><th>x25519</th></tr></thead><tbody><tr><td>Create Key Package</td><td>273.39 µs</td><td>138.24 µs</td></tr><tr><td>Create Welcome</td><td>665.77 µs</td><td>366.23 µs</td></tr><tr><td>Join a group</td><td>733.22 µs</td><td>313.37 µs</td></tr><tr><td>Self update</td><td>650.77 µs</td><td>294.49 µs</td></tr></tbody></table><h5 id=communication>Communication</h5><table><thead><tr><th></th><th>X-Wing + x25519</th><th>x25519</th></tr></thead><tbody><tr><td>Key package size</td><td>2669 Bytes</td><td>299 Bytes</td></tr><tr><td>Welcome size</td><td>5457 Bytes</td><td>716 Bytes</td></tr><tr><td>Ratchet tree size</td><td>4007 Bytes</td><td>408 Bytes</td></tr><tr><td>Self update size</td><td>3954 Bytes</td><td>495 Bytes</td></tr></tbody></table><h2 id=next-steps>Next Steps</h2><p>Using X-Wing as KEM in MLS is the easiest solution to achieve HNDL security for secure group messaging, or any use case that uses the state synchronization protocols specified in MLS.</p><p>However, X-Wing is designed as a drop-in KEM scheme with very conservative security guarantees. In the context of MLS, there may be more efficient ways to integrate HNDL protection, for example, by making use of more lightweight KEM combiners, or by other means specific to MLS. In the context of the MLS working group, we are actively discussing multiple proposals for improved HNDL protection. Once more promising candidates are available, we will publish a follow-up of this post.</p><p>A new version of OpenMLS will be released later this month, which will include this new, post-quantum secure, ciphersuite.</p></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.slim.min.js integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin=anonymous></script><script>(function(){var t,e=$("#TableOfContents");if(e.length>0){t=$(window);function n(){var n,o=t.scrollTop(),i=$(".article-entry h1, .article-entry h2, .article-entry h3, .article-entry h4, .article-entry h5, .article-entry h6"),s="";if(i.each(function(e,t){t=$(t),t.offset().top-10<=o&&(s=t.attr("id"))}),n=e.find("a.active"),n.length==1&&n.eq(0).attr("href")=="#"+s)return!0;n.each(function(e,t){$(t).removeClass("active").siblings("ul").hide()}),e.find('a[href="#'+s+'"]').parentsUntil("#TableOfContents").each(function(e,t){$(t).children("a").addClass("active").siblings("ul").show()})}t.on("scroll",n),$(document).ready(function(){e.find("a").parent("li").find("ul").hide(),n(),document.getElementsByClassName("article-toc")[0].style.display=""})}})()</script><footer class=article-footer><ul class=article-tag-list><li class=article-tag-list-item><a class=article-tag-list-link href=https://openmls.tech/blog/tags/mls>mls</a></li><li class=article-tag-list-item><a class=article-tag-list-link href=https://openmls.tech/blog/tags/pq>pq</a></li><li class=article-tag-list-item><a class=article-tag-list-link href=https://openmls.tech/blog/tags/openmls>openmls</a></li></ul></footer></div><nav id=article-nav><a href=/blog/2023-07-20-v0_5-release/ id=article-nav-older class=article-nav-link-wrap><div class=article-nav-title>OpenMLS 0.5 released&nbsp;<span>></span></div></a></nav></article></section><footer id=footer><div class=outer><div id=footer-info class=inner>&copy; 2024 OpenMLS<br>Powered by <a href=https://gohugo.io target=_blank>Hugo</a> with theme <a href=https://github.com/carsonip/hugo-theme-minos target=_blank>Minos</a></div></div><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin=anonymous></script><script>hljs.initHighlightingOnLoad()</script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css integrity=sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0 crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js integrity=sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1 crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js integrity="sha256-ExtbCSBuYA7kq1Pz362ibde9nnsHYPt6JxuxYeZbU+c=" crossorigin=anonymous></script><script>renderMathInElement(document.body)</script><script>document.getElementById("main-nav-toggle").addEventListener("click",function(){var e=document.getElementById("header");e.classList.contains("mobile-on")?e.classList.remove("mobile-on"):e.classList.add("mobile-on")})</script></footer></div></body></html>